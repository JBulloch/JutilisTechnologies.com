<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content={get_csrf_token()} />
    <meta name="theme-color" content="#10B981" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Jutilis" />
    <link rel="manifest" href={~p"/site.webmanifest"} />
    <link rel="apple-touch-icon" sizes="180x180" href={~p"/images/apple-touch-icon.png"} />
    <link rel="icon" type="image/svg+xml" href={~p"/images/icon.svg"} />
    <link rel="icon" type="image/png" sizes="192x192" href={~p"/images/icon-192.png"} />
    <link rel="icon" type="image/png" sizes="512x512" href={~p"/images/icon-512.png"} />
    <.live_title default="Jutilis" suffix=" Â· Jutilis Technologies">
      {assigns[:page_title]}
    </.live_title>
    <link phx-track-static rel="stylesheet" href={~p"/assets/css/app.css"} />
    <script defer phx-track-static type="text/javascript" src={~p"/assets/js/app.js"}>
    </script>
    <script>
      (() => {
        const setTheme = (theme) => {
          if (theme === "system") {
            localStorage.removeItem("phx:theme");
            document.documentElement.removeAttribute("data-theme");
          } else {
            localStorage.setItem("phx:theme", theme);
            document.documentElement.setAttribute("data-theme", theme);
          }
        };
        if (!document.documentElement.hasAttribute("data-theme")) {
          setTheme(localStorage.getItem("phx:theme") || "system");
        }
        window.addEventListener("storage", (e) => e.key === "phx:theme" && setTheme(e.newValue || "system"));

        window.addEventListener("phx:set-theme", (e) => setTheme(e.target.dataset.phxTheme));
      })();
    </script>
  </head>
  <body class="bg-base-100 text-base-content">
    <!-- Global Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-base-100/95 backdrop-blur-md border-b border-base-300">
      <div class="mx-auto max-w-7xl px-6 lg:px-8">
        <div class="flex h-16 items-center justify-between">
          <!-- Logo -->
          <a href="/" class="flex items-center gap-3">
            <div class="flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-emerald-600 to-teal-700 shadow-md">
              <span class="text-sm font-bold text-white">&#123;JuT&#125;</span>
            </div>
            <span class="text-lg font-bold text-base-content hidden sm:block">Jutilis</span>
          </a>
          
<!-- Desktop Navigation -->
          <div class="flex items-center gap-4">
            <%= if assigns[:current_scope] && @current_scope do %>
              <!-- Admin Navigation -->
              <a
                href="/admin/dashboard"
                class="text-sm font-semibold text-base-content/70 hover:text-primary transition-colors"
              >
                Dashboard
              </a>
              <a
                href="/admin/pitch-decks"
                class="text-sm font-semibold text-base-content/70 hover:text-primary transition-colors"
              >
                Pitch Decks
              </a>
              <a
                href="/admin/ventures"
                class="text-sm font-semibold text-base-content/70 hover:text-primary transition-colors"
              >
                Ventures
              </a>
            <% else %>
              <!-- Public Navigation -->
              <a
                href="/#ventures"
                class="text-sm font-semibold text-base-content/70 hover:text-primary transition-colors hidden md:block"
              >
                Ventures
              </a>
              <a
                href="/investors/pitch-decks"
                class="text-sm font-semibold text-base-content/70 hover:text-primary transition-colors hidden md:block"
              >
                Pitch Decks
              </a>
            <% end %>
            
<!-- Theme Toggle -->
            <button
              type="button"
              onclick="const html = document.documentElement; const current = html.getAttribute('data-theme'); const newTheme = current === 'dark' ? 'light' : 'dark'; html.setAttribute('data-theme', newTheme); localStorage.setItem('phx:theme', newTheme);"
              class="rounded-lg p-2 text-base-content/70 hover:text-primary hover:bg-base-200 transition-all"
              aria-label="Toggle theme"
            >
              <svg class="h-5 w-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                  clip-rule="evenodd"
                />
              </svg>
              <svg class="h-5 w-5 block dark:hidden" fill="currentColor" viewBox="0 0 20 20">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
              </svg>
            </button>

            <%= if assigns[:current_scope] && @current_scope do %>
              <.link href="/users/log-out" method="delete" class="btn btn-ghost btn-sm">
                Log out
              </.link>
            <% else %>
              <a href="/users/log-in" class="btn btn-primary btn-sm">
                Admin
              </a>
            <% end %>
          </div>
        </div>
      </div>
    </nav>
    
<!-- Spacer for fixed nav -->
    <div class="h-16"></div>

    {@inner_content}
  </body>
</html>
